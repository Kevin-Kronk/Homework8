[
  {
    "objectID": "Homework8.html",
    "href": "Homework8.html",
    "title": "Homework8",
    "section": "",
    "text": "Seoul Bike Sharing Demand dataset from the UCI Machine Learning Repository.\n\n# Load Libraries\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.4.1 ──\n✔ broom        1.0.10     ✔ rsample      1.3.1 \n✔ dials        1.4.2      ✔ tailor       0.1.0 \n✔ infer        1.0.9      ✔ tune         2.0.1 \n✔ modeldata    1.5.1      ✔ workflows    1.3.0 \n✔ parsnip      1.3.3      ✔ workflowsets 1.1.1 \n✔ recipes      1.3.1      ✔ yardstick    1.3.2 \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\n\n\n#Loading in the csv file while setting the column names and types\nbike_sharing &lt;- read_csv(\"SeoulBikeData.csv\", \n                         col_names = c(\"Date\", \"Rented_Bike_Count\", \"Hour\",\n                                       \"Temperature\", \"Humidity\", \"Wind_Speed\",\n                                       \"Visibility\", \"Dew_Point_Temperature\",\n                                       \"Solar_Radiation\", \"Rainfall\", \"Snowfall\",\n                                       \"Seasons\", \"Holiday\", \"Functioning_Day\"),\n                         col_types = c(\"cnnnnnnnnnnccc\"),\n                         skip = 1)\nbike_sharing\n\n# A tibble: 8,760 × 14\n   Date       Rented_Bike_Count  Hour Temperature Humidity Wind_Speed Visibility\n   &lt;chr&gt;                  &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n 1 01/12/2017               254     0        -5.2       37        2.2       2000\n 2 01/12/2017               204     1        -5.5       38        0.8       2000\n 3 01/12/2017               173     2        -6         39        1         2000\n 4 01/12/2017               107     3        -6.2       40        0.9       2000\n 5 01/12/2017                78     4        -6         36        2.3       2000\n 6 01/12/2017               100     5        -6.4       37        1.5       2000\n 7 01/12/2017               181     6        -6.6       35        1.3       2000\n 8 01/12/2017               460     7        -7.4       38        0.9       2000\n 9 01/12/2017               930     8        -7.6       37        1.1       2000\n10 01/12/2017               490     9        -6.5       27        0.5       1928\n# ℹ 8,750 more rows\n# ℹ 7 more variables: Dew_Point_Temperature &lt;dbl&gt;, Solar_Radiation &lt;dbl&gt;,\n#   Rainfall &lt;dbl&gt;, Snowfall &lt;dbl&gt;, Seasons &lt;chr&gt;, Holiday &lt;chr&gt;,\n#   Functioning_Day &lt;chr&gt;"
  },
  {
    "objectID": "Homework8.html#data",
    "href": "Homework8.html#data",
    "title": "Homework8",
    "section": "",
    "text": "Seoul Bike Sharing Demand dataset from the UCI Machine Learning Repository.\n\n# Load Libraries\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.4.1 ──\n✔ broom        1.0.10     ✔ rsample      1.3.1 \n✔ dials        1.4.2      ✔ tailor       0.1.0 \n✔ infer        1.0.9      ✔ tune         2.0.1 \n✔ modeldata    1.5.1      ✔ workflows    1.3.0 \n✔ parsnip      1.3.3      ✔ workflowsets 1.1.1 \n✔ recipes      1.3.1      ✔ yardstick    1.3.2 \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\n\n\n#Loading in the csv file while setting the column names and types\nbike_sharing &lt;- read_csv(\"SeoulBikeData.csv\", \n                         col_names = c(\"Date\", \"Rented_Bike_Count\", \"Hour\",\n                                       \"Temperature\", \"Humidity\", \"Wind_Speed\",\n                                       \"Visibility\", \"Dew_Point_Temperature\",\n                                       \"Solar_Radiation\", \"Rainfall\", \"Snowfall\",\n                                       \"Seasons\", \"Holiday\", \"Functioning_Day\"),\n                         col_types = c(\"cnnnnnnnnnnccc\"),\n                         skip = 1)\nbike_sharing\n\n# A tibble: 8,760 × 14\n   Date       Rented_Bike_Count  Hour Temperature Humidity Wind_Speed Visibility\n   &lt;chr&gt;                  &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n 1 01/12/2017               254     0        -5.2       37        2.2       2000\n 2 01/12/2017               204     1        -5.5       38        0.8       2000\n 3 01/12/2017               173     2        -6         39        1         2000\n 4 01/12/2017               107     3        -6.2       40        0.9       2000\n 5 01/12/2017                78     4        -6         36        2.3       2000\n 6 01/12/2017               100     5        -6.4       37        1.5       2000\n 7 01/12/2017               181     6        -6.6       35        1.3       2000\n 8 01/12/2017               460     7        -7.4       38        0.9       2000\n 9 01/12/2017               930     8        -7.6       37        1.1       2000\n10 01/12/2017               490     9        -6.5       27        0.5       1928\n# ℹ 8,750 more rows\n# ℹ 7 more variables: Dew_Point_Temperature &lt;dbl&gt;, Solar_Radiation &lt;dbl&gt;,\n#   Rainfall &lt;dbl&gt;, Snowfall &lt;dbl&gt;, Seasons &lt;chr&gt;, Holiday &lt;chr&gt;,\n#   Functioning_Day &lt;chr&gt;"
  },
  {
    "objectID": "Homework8.html#eda",
    "href": "Homework8.html#eda",
    "title": "Homework8",
    "section": "EDA",
    "text": "EDA\nTo start we will check for missing data. From the output there is no missing data.\n\n# Sum up all of the NA values for each column\ncolSums(is.na(bike_sharing))\n\n                 Date     Rented_Bike_Count                  Hour \n                    0                     0                     0 \n          Temperature              Humidity            Wind_Speed \n                    0                     0                     0 \n           Visibility Dew_Point_Temperature       Solar_Radiation \n                    0                     0                     0 \n             Rainfall              Snowfall               Seasons \n                    0                     0                     0 \n              Holiday       Functioning_Day \n                    0                     0 \n\n\nNext we will look at column types and the values within columns.\n\n# Structure of the data\nstr(bike_sharing)\n\nspc_tbl_ [8,760 × 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Date                 : chr [1:8760] \"01/12/2017\" \"01/12/2017\" \"01/12/2017\" \"01/12/2017\" ...\n $ Rented_Bike_Count    : num [1:8760] 254 204 173 107 78 100 181 460 930 490 ...\n $ Hour                 : num [1:8760] 0 1 2 3 4 5 6 7 8 9 ...\n $ Temperature          : num [1:8760] -5.2 -5.5 -6 -6.2 -6 -6.4 -6.6 -7.4 -7.6 -6.5 ...\n $ Humidity             : num [1:8760] 37 38 39 40 36 37 35 38 37 27 ...\n $ Wind_Speed           : num [1:8760] 2.2 0.8 1 0.9 2.3 1.5 1.3 0.9 1.1 0.5 ...\n $ Visibility           : num [1:8760] 2000 2000 2000 2000 2000 ...\n $ Dew_Point_Temperature: num [1:8760] -17.6 -17.6 -17.7 -17.6 -18.6 -18.7 -19.5 -19.3 -19.8 -22.4 ...\n $ Solar_Radiation      : num [1:8760] 0 0 0 0 0 0 0 0 0.01 0.23 ...\n $ Rainfall             : num [1:8760] 0 0 0 0 0 0 0 0 0 0 ...\n $ Snowfall             : num [1:8760] 0 0 0 0 0 0 0 0 0 0 ...\n $ Seasons              : chr [1:8760] \"Winter\" \"Winter\" \"Winter\" \"Winter\" ...\n $ Holiday              : chr [1:8760] \"No Holiday\" \"No Holiday\" \"No Holiday\" \"No Holiday\" ...\n $ Functioning_Day      : chr [1:8760] \"Yes\" \"Yes\" \"Yes\" \"Yes\" ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Date = col_character(),\n  ..   Rented_Bike_Count = col_number(),\n  ..   Hour = col_number(),\n  ..   Temperature = col_number(),\n  ..   Humidity = col_number(),\n  ..   Wind_Speed = col_number(),\n  ..   Visibility = col_number(),\n  ..   Dew_Point_Temperature = col_number(),\n  ..   Solar_Radiation = col_number(),\n  ..   Rainfall = col_number(),\n  ..   Snowfall = col_number(),\n  ..   Seasons = col_character(),\n  ..   Holiday = col_character(),\n  ..   Functioning_Day = col_character()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt; \n\n\nDate, Seasons, Holiday, and Functioning_Day were all set to character when loading the file. All of the other variables were set to numeric.\nTo look at the basic summary statistics of numerical variables, the summary function can be used. Most of the variables look reasonable, though there are some like Rainfall and Snowfall that have at least half of the data being 0. Density plots or box plots could be used to check the distributions of the data.\n\n# Basic Summary Statistics for Numerical Variables\nsummary(bike_sharing)\n\n     Date           Rented_Bike_Count      Hour        Temperature    \n Length:8760        Min.   :   0.0    Min.   : 0.00   Min.   :-17.80  \n Class :character   1st Qu.: 191.0    1st Qu.: 5.75   1st Qu.:  3.50  \n Mode  :character   Median : 504.5    Median :11.50   Median : 13.70  \n                    Mean   : 704.6    Mean   :11.50   Mean   : 12.88  \n                    3rd Qu.:1065.2    3rd Qu.:17.25   3rd Qu.: 22.50  \n                    Max.   :3556.0    Max.   :23.00   Max.   : 39.40  \n    Humidity       Wind_Speed      Visibility   Dew_Point_Temperature\n Min.   : 0.00   Min.   :0.000   Min.   :  27   Min.   :-30.600      \n 1st Qu.:42.00   1st Qu.:0.900   1st Qu.: 940   1st Qu.: -4.700      \n Median :57.00   Median :1.500   Median :1698   Median :  5.100      \n Mean   :58.23   Mean   :1.725   Mean   :1437   Mean   :  4.074      \n 3rd Qu.:74.00   3rd Qu.:2.300   3rd Qu.:2000   3rd Qu.: 14.800      \n Max.   :98.00   Max.   :7.400   Max.   :2000   Max.   : 27.200      \n Solar_Radiation     Rainfall          Snowfall         Seasons         \n Min.   :0.0000   Min.   : 0.0000   Min.   :0.00000   Length:8760       \n 1st Qu.:0.0000   1st Qu.: 0.0000   1st Qu.:0.00000   Class :character  \n Median :0.0100   Median : 0.0000   Median :0.00000   Mode  :character  \n Mean   :0.5691   Mean   : 0.1487   Mean   :0.07507                     \n 3rd Qu.:0.9300   3rd Qu.: 0.0000   3rd Qu.:0.00000                     \n Max.   :3.5200   Max.   :35.0000   Max.   :8.80000                     \n   Holiday          Functioning_Day   \n Length:8760        Length:8760       \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n                                      \n                                      \n                                      \n\n\nFor categorical variables we can look at the values that they take on.\n\n# Finds the count of the Date values\nbike_sharing |&gt;\n  group_by(Date) |&gt;\n  summarize(count = n())\n\n# A tibble: 365 × 2\n   Date       count\n   &lt;chr&gt;      &lt;int&gt;\n 1 01/01/2018    24\n 2 01/02/2018    24\n 3 01/03/2018    24\n 4 01/04/2018    24\n 5 01/05/2018    24\n 6 01/06/2018    24\n 7 01/07/2018    24\n 8 01/08/2018    24\n 9 01/09/2018    24\n10 01/10/2018    24\n# ℹ 355 more rows\n\n\nThere are 24 values for each date, referring to each hour of the day. Overall, there are 365 days in this dataset.\n\n# Finds the count of the four seasons\nbike_sharing |&gt;\n  group_by(Seasons) |&gt;\n  summarize(count = n())\n\n# A tibble: 4 × 2\n  Seasons count\n  &lt;chr&gt;   &lt;int&gt;\n1 Autumn   2184\n2 Spring   2208\n3 Summer   2208\n4 Winter   2160\n\n\nAs you would expect there is a roughly equal spread of entries for each season.\n\n# Finds the count of the holidays\nbike_sharing |&gt;\n  group_by(Holiday) |&gt;\n  summarize(count = n())\n\n# A tibble: 2 × 2\n  Holiday    count\n  &lt;chr&gt;      &lt;int&gt;\n1 Holiday      432\n2 No Holiday  8328\n\n\n\n# Finds the count of the functioning days\nbike_sharing |&gt;\n  group_by(Functioning_Day) |&gt;\n  summarize(count = n())\n\n# A tibble: 2 × 2\n  Functioning_Day count\n  &lt;chr&gt;           &lt;int&gt;\n1 No                295\n2 Yes              8465\n\n\nThere’s far fewer holiday entries than non-Holiday, as well as far fewer non-functioning days than functioning ones.\nThe Date will be converted to a datetime variable, and the three categorical variables, Seasons, Holiday, and Functioning_Day will be converted to factors so they can be used in a model.\n\n# Converting variables using mutate to store as the same name\nbike_sharing &lt;- bike_sharing |&gt;\n  mutate(Date = as.POSIXct(Date, format = \"%d/%m/%Y\"),\n         Seasons = as.factor(Seasons),\n         Holiday = as.factor(Holiday),\n         Functioning_Day = as.factor(Functioning_Day))\n\nbike_sharing\n\n# A tibble: 8,760 × 14\n   Date                Rented_Bike_Count  Hour Temperature Humidity Wind_Speed\n   &lt;dttm&gt;                          &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n 1 2017-12-01 00:00:00               254     0        -5.2       37        2.2\n 2 2017-12-01 00:00:00               204     1        -5.5       38        0.8\n 3 2017-12-01 00:00:00               173     2        -6         39        1  \n 4 2017-12-01 00:00:00               107     3        -6.2       40        0.9\n 5 2017-12-01 00:00:00                78     4        -6         36        2.3\n 6 2017-12-01 00:00:00               100     5        -6.4       37        1.5\n 7 2017-12-01 00:00:00               181     6        -6.6       35        1.3\n 8 2017-12-01 00:00:00               460     7        -7.4       38        0.9\n 9 2017-12-01 00:00:00               930     8        -7.6       37        1.1\n10 2017-12-01 00:00:00               490     9        -6.5       27        0.5\n# ℹ 8,750 more rows\n# ℹ 8 more variables: Visibility &lt;dbl&gt;, Dew_Point_Temperature &lt;dbl&gt;,\n#   Solar_Radiation &lt;dbl&gt;, Rainfall &lt;dbl&gt;, Snowfall &lt;dbl&gt;, Seasons &lt;fct&gt;,\n#   Holiday &lt;fct&gt;, Functioning_Day &lt;fct&gt;\n\n\nThe response variable of our data is the Rented Bike Count. We want to know how the explanatory variables vary with it. We can look at some summary statistics for each numeric variable like mean, standard deviation, covariance with rented bike count, and correlation with rented bike count.\n\n# For numeric columns that aren't rented bike count or hour\n# Find the mean, sd, and cov and cor with rented bike count\nbike_sharing |&gt;\n  summarize(across(where(is.numeric) & !matches(\"Rented_Bike_Count|Hour\"),\n                   .fns = list(mean = mean,\n                               sd = sd,\n                               cov_Bike = ~cov(.x, Rented_Bike_Count),\n                               cor_Bike = ~cor(.x, Rented_Bike_Count)),\n                   .names = \"{.col}_{.fn}\")) |&gt;\n  # Round all values to 3 decimal places\n  summarize(across(everything(), ~round(.x,3))) |&gt;\n  # This creates one wide tibble, but we want it to be longer\n  pivot_longer(\n    # Choose all the columns from above\n    cols = everything(),\n    # Split up the variable name into a column, then all the value columns\n    names_to = c(\"variable\", \".value\"),\n    # Have to use regex to split on the underscore that separates the \n    # variable name from the function name\n    names_pattern = \"^(.*)_(mean|sd|cor_Bike|cov_Bike)$\"\n  )\n\n# A tibble: 8 × 5\n  variable                  mean      sd cov_Bike cor_Bike\n  &lt;chr&gt;                    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n1 Temperature             12.9    11.9     4149.     0.539\n2 Humidity                58.2    20.4    -2624.    -0.2  \n3 Wind_Speed               1.72    1.04      81.0    0.121\n4 Visibility            1437.    608.     78188.     0.199\n5 Dew_Point_Temperature    4.07   13.1     3199.     0.38 \n6 Solar_Radiation          0.569   0.869    147.     0.262\n7 Rainfall                 0.149   1.13     -89.6   -0.123\n8 Snowfall                 0.075   0.437    -39.9   -0.142\n\n\nThese variables are on fairly different scales, so we may need to standardize them. The variable that correlated most highly with bike rentals is temperature. Humidity, rainfall, and snowfall are all negatively correlated with bike rentals and you might expect. That being said, a lot of these correlations are weak.\nNext, here are the summary statistics of Rented Bike Count across the levels of each categorical variable.\n\n# Summary Statistics of Rented Bike Count across Seasons\nbike_sharing |&gt;\n  group_by(Seasons) |&gt;\n  summarize(mean_bikes = mean(Rented_Bike_Count),\n            med_bikes = median(Rented_Bike_Count),\n            SD_bikes = sd(Rented_Bike_Count),\n            IQR_bikes = IQR(Rented_Bike_Count))\n\n# A tibble: 4 × 5\n  Seasons mean_bikes med_bikes SD_bikes IQR_bikes\n  &lt;fct&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 Autumn        820.      764.     651.      956.\n2 Spring        730.      583      622.      899.\n3 Summer       1034.      906.     690.      916.\n4 Winter        226.      203      150.      195 \n\n\nThere seems to be a clear pattern in that more bikes are rented in the spring, summer, and fall, than in the winter, which is what we would expect due to the cold weather.\n\n# Summary Statistics of Rented Bike Count across Holidays\nbike_sharing |&gt;\n  group_by(Holiday) |&gt;\n  summarize(mean_bikes = mean(Rented_Bike_Count),\n            med_bikes = median(Rented_Bike_Count),\n            SD_bikes = sd(Rented_Bike_Count),\n            IQR_bikes = IQR(Rented_Bike_Count))\n\n# A tibble: 2 × 5\n  Holiday    mean_bikes med_bikes SD_bikes IQR_bikes\n  &lt;fct&gt;           &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 Holiday          500.      240      571.      657.\n2 No Holiday       715.      524.     647.      873 \n\n\nInterestingly enough more bikes are sold on non-holidays, but that may also be because a lot of holidays are during the colder months.\n\n# Summary Statistics of Rented Bike Count across Functioning Days\nbike_sharing |&gt;\n  group_by(Functioning_Day) |&gt;\n  summarize(mean_bikes = mean(Rented_Bike_Count),\n            med_bikes = median(Rented_Bike_Count),\n            SD_bikes = sd(Rented_Bike_Count),\n            IQR_bikes = IQR(Rented_Bike_Count))\n\n# A tibble: 2 × 5\n  Functioning_Day mean_bikes med_bikes SD_bikes IQR_bikes\n  &lt;fct&gt;                &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 No                      0          0       0          0\n2 Yes                   729.       542     642.       870\n\n\nFinally, for the Functioning Day variable no bikes were sold on non-functioning days. This means that future non-functioning days will most likely also have 0 bikes rented. Therefore, we will subset the data to only look on the days that were functioning.\n\n# Subsetting the data for only Functioning Days, then removing variable\nbike_sharing &lt;- bike_sharing |&gt;\n  filter(Functioning_Day == \"Yes\") |&gt;\n  select(everything(), -Functioning_Day)\n\nbike_sharing\n\n# A tibble: 8,465 × 13\n   Date                Rented_Bike_Count  Hour Temperature Humidity Wind_Speed\n   &lt;dttm&gt;                          &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n 1 2017-12-01 00:00:00               254     0        -5.2       37        2.2\n 2 2017-12-01 00:00:00               204     1        -5.5       38        0.8\n 3 2017-12-01 00:00:00               173     2        -6         39        1  \n 4 2017-12-01 00:00:00               107     3        -6.2       40        0.9\n 5 2017-12-01 00:00:00                78     4        -6         36        2.3\n 6 2017-12-01 00:00:00               100     5        -6.4       37        1.5\n 7 2017-12-01 00:00:00               181     6        -6.6       35        1.3\n 8 2017-12-01 00:00:00               460     7        -7.4       38        0.9\n 9 2017-12-01 00:00:00               930     8        -7.6       37        1.1\n10 2017-12-01 00:00:00               490     9        -6.5       27        0.5\n# ℹ 8,455 more rows\n# ℹ 7 more variables: Visibility &lt;dbl&gt;, Dew_Point_Temperature &lt;dbl&gt;,\n#   Solar_Radiation &lt;dbl&gt;, Rainfall &lt;dbl&gt;, Snowfall &lt;dbl&gt;, Seasons &lt;fct&gt;,\n#   Holiday &lt;fct&gt;\n\n\nNext we will summarize the data across the hours so there is only one observation per day.\n\n# Summarizing data to only have one observation per day\nbike_sharing &lt;- bike_sharing |&gt;\n  group_by(Date, Seasons, Holiday) |&gt;\n  summarize(across(c(Rented_Bike_Count, Rainfall, Snowfall), sum),\n            across(c(Temperature, Humidity, Wind_Speed, Visibility,\n                        Dew_Point_Temperature, Solar_Radiation), mean),\n            .groups = \"drop\")\n\nbike_sharing\n\n# A tibble: 353 × 12\n   Date                Seasons Holiday    Rented_Bike_Count Rainfall Snowfall\n   &lt;dttm&gt;              &lt;fct&gt;   &lt;fct&gt;                  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n 1 2017-12-01 00:00:00 Winter  No Holiday              9539      0        0  \n 2 2017-12-02 00:00:00 Winter  No Holiday              8523      0        0  \n 3 2017-12-03 00:00:00 Winter  No Holiday              7222      4        0  \n 4 2017-12-04 00:00:00 Winter  No Holiday              8729      0.1      0  \n 5 2017-12-05 00:00:00 Winter  No Holiday              8307      0        0  \n 6 2017-12-06 00:00:00 Winter  No Holiday              6669      1.3      8.6\n 7 2017-12-07 00:00:00 Winter  No Holiday              8549      0       10.4\n 8 2017-12-08 00:00:00 Winter  No Holiday              8032      0        0  \n 9 2017-12-09 00:00:00 Winter  No Holiday              7233      0        0  \n10 2017-12-10 00:00:00 Winter  No Holiday              3453      4.1     32.5\n# ℹ 343 more rows\n# ℹ 6 more variables: Temperature &lt;dbl&gt;, Humidity &lt;dbl&gt;, Wind_Speed &lt;dbl&gt;,\n#   Visibility &lt;dbl&gt;, Dew_Point_Temperature &lt;dbl&gt;, Solar_Radiation &lt;dbl&gt;\n\n\nNow that we’ve processed the data, we can look at the summary statistics again as well as some correlations and plots.\n\n# Basic Summary Statistics\n# This time it also shows the values in Date or Categorical variables\nsummary(bike_sharing)\n\n      Date                          Seasons         Holiday   \n Min.   :2017-12-01 00:00:00.00   Autumn:81   Holiday   : 17  \n 1st Qu.:2018-02-27 00:00:00.00   Spring:90   No Holiday:336  \n Median :2018-05-28 00:00:00.00   Summer:92                   \n Mean   :2018-05-28 12:11:02.89   Winter:90                   \n 3rd Qu.:2018-08-24 00:00:00.00                               \n Max.   :2018-11-30 00:00:00.00                               \n Rented_Bike_Count    Rainfall         Snowfall       Temperature     \n Min.   :  977     Min.   : 0.000   Min.   : 0.000   Min.   :-14.738  \n 1st Qu.: 6967     1st Qu.: 0.000   1st Qu.: 0.000   1st Qu.:  3.304  \n Median :18563     Median : 0.000   Median : 0.000   Median : 13.738  \n Mean   :17485     Mean   : 3.576   Mean   : 1.863   Mean   : 12.776  \n 3rd Qu.:26285     3rd Qu.: 0.500   3rd Qu.: 0.000   3rd Qu.: 22.592  \n Max.   :36149     Max.   :95.500   Max.   :78.700   Max.   : 33.742  \n    Humidity       Wind_Speed       Visibility     Dew_Point_Temperature\n Min.   :22.25   Min.   :0.6625   Min.   : 214.3   Min.   :-27.750      \n 1st Qu.:47.58   1st Qu.:1.3042   1st Qu.:1087.0   1st Qu.: -5.188      \n Median :57.17   Median :1.6583   Median :1557.8   Median :  4.612      \n Mean   :58.17   Mean   :1.7261   Mean   :1434.0   Mean   :  3.954      \n 3rd Qu.:67.71   3rd Qu.:1.9542   3rd Qu.:1874.3   3rd Qu.: 14.921      \n Max.   :95.88   Max.   :4.0000   Max.   :2000.0   Max.   : 25.038      \n Solar_Radiation  \n Min.   :0.02917  \n 1st Qu.:0.28333  \n Median :0.56500  \n Mean   :0.56773  \n 3rd Qu.:0.82000  \n Max.   :1.21667  \n\n\n\n# Correlations between numeric variables\nbike_sharing |&gt;\n  select(where(is.numeric)) |&gt;\n  cor(use = \"pairwise.complete.obs\")\n\n                      Rented_Bike_Count    Rainfall    Snowfall  Temperature\nRented_Bike_Count            1.00000000 -0.23910905 -0.26529110  0.753076732\nRainfall                    -0.23910905  1.00000000 -0.02313404  0.144517274\nSnowfall                    -0.26529110 -0.02313404  1.00000000 -0.266963662\nTemperature                  0.75307673  0.14451727 -0.26696366  1.000000000\nHumidity                     0.03588697  0.52864263  0.06539191  0.404167486\nWind_Speed                  -0.19288142 -0.10167578  0.02088156 -0.260721792\nVisibility                   0.16599375 -0.22199387 -0.10188902  0.002336683\nDew_Point_Temperature        0.65047655  0.26456621 -0.20955286  0.962796255\nSolar_Radiation              0.73589290 -0.32270413 -0.23343056  0.550274301\n                         Humidity  Wind_Speed   Visibility\nRented_Bike_Count      0.03588697 -0.19288142  0.165993749\nRainfall               0.52864263 -0.10167578 -0.221993866\nSnowfall               0.06539191  0.02088156 -0.101889019\nTemperature            0.40416749 -0.26072179  0.002336683\nHumidity               1.00000000 -0.23425778 -0.559177334\nWind_Speed            -0.23425778  1.00000000  0.206022636\nVisibility            -0.55917733  0.20602264  1.000000000\nDew_Point_Temperature  0.63204729 -0.28770322 -0.153551591\nSolar_Radiation       -0.27444967  0.09612635  0.271395906\n                      Dew_Point_Temperature Solar_Radiation\nRented_Bike_Count                 0.6504765      0.73589290\nRainfall                          0.2645662     -0.32270413\nSnowfall                         -0.2095529     -0.23343056\nTemperature                       0.9627963      0.55027430\nHumidity                          0.6320473     -0.27444967\nWind_Speed                       -0.2877032      0.09612635\nVisibility                       -0.1535516      0.27139591\nDew_Point_Temperature             1.0000000      0.38315713\nSolar_Radiation                   0.3831571      1.00000000\n\n\nThere does seem to be a very high correlation between Temperature and Dew Point Temperature, which could potentially cause multicollinearity issues. Other than that the variable correlations seem fine. The variables most correlated with Rented Bike Count are Temperature, Dew_Point_Temperature, and Solar_Radiation. All of these are reasonably strong positive correlations.\n\nggplot(bike_sharing, aes(Date, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Date vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nFor the most part there are fewer bike rentals in the earlier part of the year than in the second half.\n\nggplot(bike_sharing, aes(Seasons, Rented_Bike_Count, color = Seasons)) +\n         geom_boxplot() +\n         labs(title = \"Seasons vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nThis reiterates what is seen in the Date scatter plot that far fewer people rent bikes in the winter. The distributions also seem to be slightly left skewed.\n\nggplot(bike_sharing, aes(Holiday, Rented_Bike_Count, color = Holiday)) +\n         geom_boxplot() +\n         labs(title = \"Holiday vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nMore people on average rent bikes on non-holidays.\n\nggplot(bike_sharing, aes(Rainfall, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Rainfall vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nSeems to be a trend that generally the more rainfall the fewer people rent bikes.\n\nggplot(bike_sharing, aes(Snowfall, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Snowfall vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nIn this case the trend seems to be that if there’s any snowfall then very few people rent bikes.\n\nggplot(bike_sharing, aes(Temperature, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Temperature vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nGenerally the warmer the weather, the more people will rent bikes. The trend looks like it starts to decrease though once it gets too hot.\n\nggplot(bike_sharing, aes(Humidity, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Humidity vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nThere doesn’t seem to be much of a trend between humidity and bike rentals.\n\nggplot(bike_sharing, aes(Wind_Speed, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Wind_Speed vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nGenerally wind speed doesn’t seem to affect bike rentals until it gets extremely windy.\n\nggplot(bike_sharing, aes(Visibility, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Visibility vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nVisibility doesn’t seem to have a trend with bike rentals.\n\nggplot(bike_sharing, aes(Dew_Point_Temperature, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Dew_Point_Temperature vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nAs we would expect based on the high correlation, the relationship between dew point temperature and bike rentals looks very similar to temperature.\n\nggplot(bike_sharing, aes(Solar_Radiation, Rented_Bike_Count)) +\n         geom_point() +\n         labs(title = \"Solar_Radiation vs Rented Bike Count\")\n\n\n\n\n\n\n\n\nGenerally it seems like the more solar radiation the more bike rentals. People probably like to ride bikes on nice sunny days. That being said, there’s a lot of variability here."
  },
  {
    "objectID": "Homework8.html#split-the-data",
    "href": "Homework8.html#split-the-data",
    "title": "Homework8",
    "section": "Split the Data",
    "text": "Split the Data\nTo train and test a model we need to split the data into a train and test set. The training set will then use cross validation to average out the error metric across the entire training set to see which model performed best.\n\n# Random seed\nset.seed(10)\n\n# Get the split indexes and split the training and test set, stratified by seasons\nbike_share_split &lt;- initial_split(bike_sharing, prop = 0.75, strata=Seasons)\nbike_train &lt;- training(bike_share_split)\nbike_test &lt;- testing(bike_share_split)\n\n# Get the 10 fold CV splits\nbike_folds &lt;- vfold_cv(bike_train, v = 10)"
  },
  {
    "objectID": "Homework8.html#fitting-mlr-models",
    "href": "Homework8.html#fitting-mlr-models",
    "title": "Homework8",
    "section": "Fitting MLR Models",
    "text": "Fitting MLR Models\nFirst Recipe will be a basic multiple linear regression with rented bike count as the response.\n\nbike_rec &lt;- \n  recipe(Rented_Bike_Count ~ ., data = bike_train) |&gt;\n  # Don't include Date in the model, make it a unique ID\n  update_role(Date, new_role = \"ID\") |&gt;\n  # Find the day of the week, use it to determine the weekend, then drop Date_dow\n  step_date(Date, features = c(\"dow\")) |&gt;\n  step_mutate(Weekend = factor(if_else((Date_dow == \"Sat\" | \n                                        Date_dow == \"Sun\"),\n                               \"Yes\", \"No\"))) |&gt;\n  step_rm(Date_dow) |&gt;\n  # Normalize all numeric variables to get them on the same scale\n  step_normalize(all_numeric(), -all_outcomes()) |&gt;\n  # Create dummy variables for categorical variables\n  step_dummy(Seasons, Holiday, Weekend) #|&gt;\n  #prep(training = bike_train) |&gt;\n  #bake(bike_train)\n\nSecond Recipe will be the same as the first but including some interaction terms.\n\nbike_rec2 &lt;- \n  recipe(Rented_Bike_Count ~ ., data = bike_train) |&gt;\n  # Don't include Date in the model, make it a unique ID\n  update_role(Date, new_role = \"ID\") |&gt;\n  # Find the day of the week, use it to determine the weekend, then drop Date_dow\n  step_date(Date, features = c(\"dow\")) |&gt;\n  step_mutate(Weekend = factor(if_else((Date_dow == \"Sat\" | \n                                        Date_dow == \"Sun\"),\n                               \"Yes\", \"No\"))) |&gt;\n  step_rm(Date_dow) |&gt;\n  # Normalize all numeric variables to get them on the same scale\n  step_normalize(all_numeric(), -all_outcomes()) |&gt;\n  # Create dummy variables for categorical variables\n  step_dummy(Seasons, Holiday, Weekend) |&gt;\n  # Create interaction terms between variables\n  step_interact(terms = ~ (starts_with(\"Seasons\")):(Holiday_No.Holiday +\n                                                      Temperature)) |&gt;\n  step_interact(terms = ~Temperature:Rainfall) #|&gt;\n  #prep(training = bike_train) |&gt;\n  #bake(bike_train)\n\nThird Recipe will be the same as the second but also including quadratic terms for all of the numeric variables.\n\nbike_rec3 &lt;- \n  recipe(Rented_Bike_Count ~ ., data = bike_train) |&gt;\n  # Don't include Date in the model, make it a unique ID\n  update_role(Date, new_role = \"ID\") |&gt;\n  # Find the day of the week, use it to determine the weekend, then drop Date_dow\n  step_date(Date, features = c(\"dow\")) |&gt;\n  step_mutate(Weekend = factor(if_else((Date_dow == \"Sat\" | \n                                        Date_dow == \"Sun\"),\n                               \"Yes\", \"No\"))) |&gt;\n  step_rm(Date_dow) |&gt;\n  # Normalize all numeric variables to get them on the same scale\n  step_normalize(all_numeric(), -all_outcomes()) |&gt;\n  # Create quadratic terms for the numeric variables\n  step_poly(all_numeric_predictors(), degree = 2) |&gt;\n  # Create dummy variables for categorical variables\n  step_dummy(Seasons, Holiday, Weekend) |&gt;\n  # Create interaction terms between variables\n  step_interact(terms = ~ (starts_with(\"Seasons\")):(Holiday_No.Holiday + \n                                                    Temperature_poly_1)) |&gt;\n  step_interact(terms = ~Temperature_poly_1:Rainfall_poly_1) #|&gt;\n  #prep(training = bike_train) |&gt;\n  #bake(bike_train)\n\n\n# Set up the linear model fit to use the \"lm\" engine\nbike_mod &lt;- linear_reg() |&gt;\n  set_engine(\"lm\") |&gt;\n  translate()\n\nbike_mod\n\nLinear Regression Model Specification (regression)\n\nComputational engine: lm \n\nModel fit template:\nstats::lm(formula = missing_arg(), data = missing_arg(), weights = missing_arg())\n\n\n\n# Create workflows for each recipe each using the same model engine\n# Then fit the models using 10 fold CV\nbike_CV_fit &lt;- workflow() |&gt;\n  add_recipe(bike_rec) |&gt;\n  add_model(bike_mod) |&gt;\n  fit_resamples(bike_folds)\n\nbike_CV_fit2 &lt;- workflow() |&gt;\n  add_recipe(bike_rec2) |&gt;\n  add_model(bike_mod) |&gt;\n  fit_resamples(bike_folds)\n\nbike_CV_fit3 &lt;- workflow() |&gt;\n  add_recipe(bike_rec3) |&gt;\n  add_model(bike_mod) |&gt;\n  fit_resamples(bike_folds)\n\n\n# Get metrics for each model fit\nrbind(bike_CV_fit |&gt; collect_metrics(),\n      bike_CV_fit2 |&gt; collect_metrics(),\n      bike_CV_fit3 |&gt; collect_metrics())\n\n# A tibble: 6 × 6\n  .metric .estimator     mean     n  std_err .config        \n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard   4248.       10 226.     pre0_mod0_post0\n2 rsq     standard      0.813    10   0.0197 pre0_mod0_post0\n3 rmse    standard   3080.       10 278.     pre0_mod0_post0\n4 rsq     standard      0.902    10   0.0183 pre0_mod0_post0\n5 rmse    standard   3035.       10 256.     pre0_mod0_post0\n6 rsq     standard      0.907    10   0.0176 pre0_mod0_post0\n\n\nThe third fit which had dummy variables, interactions, and quadratics had the lowest average training cross validation root mean squared error. Therefore this will be the model we use to train on the full set.\n\n# Create a workflow for the third recipe with the linear model engine\n# Then fit to the entire training set and test on the test set\nbike_best &lt;- workflow() |&gt;\n  add_recipe(bike_rec3) |&gt;\n  add_model(bike_mod) |&gt;\n  last_fit(bike_share_split)\n\n# Get the test set error\nbike_best |&gt;\n  collect_metrics()\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config        \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard    2963.    pre0_mod0_post0\n2 rsq     standard       0.918 pre0_mod0_post0\n\n\nFor the third bike model that we’ve chosen, the RMSE on the test set was 2963.4.\nFinally, we will get the final best model parameter estimates, standard errors, test statistics, and p-values.\n\n# Get the final model coefficient table\nbike_best |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy()\n\n# A tibble: 29 × 5\n   term               estimate std.error statistic  p.value\n   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)          16062.     1652.     9.73  5.40e-19\n 2 Rainfall_poly_1     -23217.     5887.    -3.94  1.06e- 4\n 3 Rainfall_poly_2       7543.     3152.     2.39  1.75e- 2\n 4 Snowfall_poly_1      -3928.     3287.    -1.20  2.33e- 1\n 5 Snowfall_poly_2       -688.     3075.    -0.224 8.23e- 1\n 6 Temperature_poly_1   32771.    65552.     0.500 6.18e- 1\n 7 Temperature_poly_2  -17944.    17477.    -1.03  3.06e- 1\n 8 Humidity_poly_1     -26564.    22915.    -1.16  2.48e- 1\n 9 Humidity_poly_2      -5879.     6034.    -0.974 3.31e- 1\n10 Wind_Speed_poly_1    -7101.     3430.    -2.07  3.95e- 2\n# ℹ 19 more rows"
  }
]